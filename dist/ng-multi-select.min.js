!function(){"use strict";angular.module("ng-multi-select",[]).value("version","0.1"),function(){angular.module("ng-multi-select",[]).value("version","0.1"),function(){angular.module("ng-multi-select",[]).value("version","0.1"),angular.module("ng-multi-select").directive("taDropDownGroup",function(){return{controller:function(){var e=this;e.groups=[],e.closeOthers=function(t){t.isOpen=!0,e.groups.forEach(function(e){e!=t&&(e.isOpen=!1)})},e.addGroup=function(t){e.groups.push(t)}},controllerAs:"taDropDownGroup"}}),angular.module("ng-multi-select").directive("taDropDown",["$templateCache","$timeout","$document",function(e,t,a){var i=function(e){var t=e?'<div class="ta-list-main" ng-include="\''+e+"'\"></div>":'<span  class = "ta-list-main" data-ng-bind="i[itemName]"></span>',a='<div class="multi-box"><div class="multi-box-header"><label class="control-label">{{taLabel}}:</label></div><div class="multi-box-detail"><span data-ng-bind="multiSelectItems"></span></div><div class="multi-box-icon"><i class="fa fa-sort-desc"></i></div></div><div data-ng-hide="show" class="shadow-div"><div class="form-group has-feedback"><input type="text" placeholder="search" data-ng-model="term" data-ng-change="query()" class="form-control"/><span data-ng-show="term === \'\'||!term" class="glyphicon glyphicon-search form-control-feedback"></span><span data-ng-show="term &amp;&amp; term !== \'\'" data-ng-click="cancelSearch()" class="glyphicon glyphicon-remove-circle search-box-icon"></span></div><ul class="list-unstyled"><li data-ng-show="selectedItems &amp;&amp; selectedItems.length &gt; 0" class="ta-list-header">Selected Items:</li><li item="i" data-ng-repeat="i in selectedItems" data-ng-click="vm.select(i)" class="ta-list-item">'+t+'<i class="pull-right glyphicon glyphicon-ok create-color"></i></li><li data-ng-show="defaultFlag" class="ta-list-header">Suggested List:</li><li item="i" data-ng-repeat="i in taDefaultItems" data-ng-show="defaultFlag" data-ng-click="vm.select(i)" class="ta-list-item">'+t+'</li><li data-ng-hide="defaultFlag" class="ta-list-header">Search Results: {{taItems.length}}</li><li item="i" data-ng-repeat="i in taItems | filter: term " data-ng-hide="defaultFlag" data-ng-click="vm.select(i)" class="ta-list-item">'+t+'<i data-ng-show="i.selected" class="pull-right glyphicon glyphicon-ok create-color"></i></li></ul></div>';return a};return{transclude:!0,require:["?^taDropDownGroup","taDropDown"],template:function(e,t){return i(t.taItemTemplate)},scope:{search:"&",select:"&",taItems:"=",taDefaultItems:"=",taLabel:"=",selectedItems:"=?",multiSelect:"@"},controller:["$scope",function(e){var t=this;e.defaultFlag=!0,e.items=[],e.hide=!0,t.remoteSearch=!1,e.multiSelectItems="All",e.term="",e.selectedItems||(e.selectedItems=[]),t.createActivate=function(t){e.createFlag=t},e.cancelSearch=function(){e.term="",t.remoteSearch&&(e.taItems=[]),e.defaultFlag=!0},e.showDefaultItems=function(){return e.taItems?0===e.taItems.length:!1},t.activate=function(t){e.active=t},t.activateNextItem=function(){var a=e.taItems.indexOf(e.active);t.activate(e.taItems[(a+1)%e.taItems.length])},t.activatePreviousItem=function(){var a=e.taItems.indexOf(e.active);t.activate(e.taItems[0===a?e.taItems.length-1:a-1])},t.isActive=function(t){return e.active===t},t.selectActive=function(){t.select(e.active)},t.select=function(t){t.taId=t[e.itemName];var a="",i=e.selectedItems.indexOf(t);if(t.selected)t.selected=!1,e.selectedItems.splice(i,1),e.taDefaultItems?e.taDefaultItems.push(t):e.taItems.push(t);else if(t.selected=!0,-1===i)if(e.selectedItems.push(t),e.taDefaultItems){var l=_.findIndex(e.taDefaultItems,function(a){return a[e.itemName]===t[e.itemName]});e.taDefaultItems.splice(l,1)}else{var l=_.findIndex(e.taItems,function(a){return a[e.itemName]===t[e.itemName]});e.taItems.splice(l,1)}e.selectedItems.forEach(function(t){a=a+t[e.itemName]+", "}),e.multiSelectItems=a,e.select({item:t})},t.showTooltip=function(){e.hide=!1,e.focused=!0},t.removeSelectedItem=function(){e.selectedItems.pop()},e.showCreateElement=function(){return e.term&&e.createFlag?e.term.length>=3:void 0},e.createItem=function(){var t={};t[e.itemName]=e.term,e.selectedItems.push(t),e.create({taitem:e.term}),e.term=null},e.isVisible=function(){return e.isOpen&&!e.hide&&(e.focused||e.mousedOver)},e.query=function(){e.hide=!1,e.term?(console.log(t.remoteSearch),t.remoteSearch&&e.search({term:e.term})):(t.remoteSearch&&(console.log("m here"),e.taItems=[]),e.taDefaultItems&&(e.defaultFlag=!0))}}],controllerAs:"vm",link:function(e,i,l,n){var c=n[0];c?c.addGroup(e):e.isOpen=!0;var s=n[1],o=i.find(".multi-box"),u=i.find("> .shadow-div"),r=i.parent()[0].offsetWidth;r=r>=450?r:400,s.remoteSearch=l.search?!0:!1,e.itemName=l.taName,e.taLabel=l.taLabel,i.on("click",function(e){e.stopPropagation()}),o.bind("click",function(){c&&c.closeOthers(e),e.$apply(function(){s.showTooltip()})}),a.click(function(){e.$apply(function(){e.hide=!0})}),o.bind("focus",function(){e.$apply(function(){e.focused=!0})}),o.bind("blur",function(){e.$apply(function(){e.focused=!1})}),u.bind("mouseover",function(){e.$apply(function(){e.mousedOver=!0})}),u.bind("mouseleave",function(){e.$apply(function(){e.mousedOver=!1})}),o.bind("keyup",function(t){13===t.keyCode&&e.$apply(function(){s.selectActive()}),27===t.keyCode&&e.$apply(function(){})}),o.bind("keydown",function(t){(13===t.keyCode||27===t.keyCode)&&t.preventDefault(),40===t.keyCode&&(t.preventDefault(),e.$apply(function(){s.activateNextItem()}),e.hide=!1),8!==t.keyCode||e.term||(t.preventDefault(),e.$apply(function(){s.removeSelectedItem()})),38===t.keyCode&&(t.preventDefault(),e.$apply(function(){s.activatePreviousItem()}))}),e.$watch("taItems",function(t){t&&0!==t.length&&(console.log(t),t.forEach(function(t){t.taId=t[e.itemName],e.selectedItems&&e.selectedItems.forEach(function(a){t[e.itemName]===a[e.itemName]&&(t.selected=!0)})}),e.defaultFlag=!1,s.activate(t.length?t[0]:null))},!0),e.$watch("focused",function(e){e&&t(function(){o.focus()},0,!1)}),e.$watch("isVisible()",function(e){if(e){var t=o.position(),a=o[0].offsetHeight;u.css({width:r,top:t.top+a,left:t.left,position:"absolute",display:"block","z-index":"10","background-color":"white"})}else u.css("display","none")})}}}])}()}()}();