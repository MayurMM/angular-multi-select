!function(){"use strict";angular.module("angular-multi-select",[]).value("version","0.1"),angular.module("angular-multi-select").directive("taDropDownGroup",function(){return{controller:function(){var e=this;e.groups=[],e.closeOthers=function(t){t.isOpen=!0,e.groups.forEach(function(e){e!=t&&(e.isOpen=!1)})},e.addGroup=function(t){e.groups.push(t)}},controllerAs:"taDropDownGroup"}}),angular.module("angular-multi-select").directive("taDropDown",function(e,t){return{transclude:!0,require:["?^taDropDownGroup","taDropDown"],templateUrl:"partials/directive/typeahead/template/taDropDown",scope:{search:"&",select:"&",taItems:"=",taDefaultItems:"=",taLabel:"=",selectedItems:"=",multiSelect:"@"},controller:function(e){var t=this;e.defaultFlag=!0,e.items=[],e.hide=!0,t.remoteSearch=!1,e.multiSelectItems="All",e.selectedItems||(e.selectedItems=[]),t.createActivate=function(t){e.createFlag=t},e.cancelSearch=function(){e.term="",e.taItems=[],e.defaultFlag=!0},e.showDefaultItems=function(){return console.log(e.taItems),e.taItems?0===e.taItems.length:!1},t.activate=function(t){e.active=t},t.activateNextItem=function(){var a=e.taItems.indexOf(e.active);t.activate(e.taItems[(a+1)%e.taItems.length])},t.activatePreviousItem=function(){var a=e.taItems.indexOf(e.active);t.activate(e.taItems[0===a?e.taItems.length-1:a-1])},t.isActive=function(t){return e.active===t},t.selectActive=function(){t.select(e.active)},t.select=function(t){t.taId=t[e.itemName];var a="",n=e.selectedItems.indexOf(t);if(t.selected)t.selected=!1,e.selectedItems.splice(n,1),e.taDefaultItems.push(t);else if(t.selected=!0,-1===n){e.selectedItems.push(t);var i=_.findIndex(e.taDefaultItems,function(a){return a[e.itemName]===t[e.itemName]});console.log(i),e.taDefaultItems.splice(i,1)}e.selectedItems.forEach(function(t){a=a+t[e.itemName]+", "}),e.multiSelectItems=a,e.select({item:t})},t.showTooltip=function(){e.hide=!1,e.focused=!0},t.removeSelectedItem=function(){e.selectedItems.pop()},e.showCreateElement=function(){return e.term&&e.createFlag?e.term.length>=3:void 0},e.createItem=function(){var t={};t[e.itemName]=e.term,e.selectedItems.push(t),e.create({taitem:e.term}),e.term=null},e.isVisible=function(){return e.isOpen&&!e.hide&&(e.focused||e.mousedOver)};var a=function(t){e.taItems=[];var a=new RegExp(t,"i");e.taDefaultItems.forEach(function(t){t[e.itemName].match(a)&&e.taItems.push(t)})};e.query=function(){e.hide=!1,e.term?t.remoteSearch?(console.log(e.search),e.search({term:e.term})):a(e.term):(e.taItems=[],e.defaultFlag=!0)}},link:function(a,n,i,l){var c=l[0];c&&c.addGroup(a);var o=l[1],s=n.find(".multi-box"),r=(n.find(".fa-sort-desc"),n.find("> .shadow-div")),u=n.parent()[0].offsetWidth;u=u>=450?u:400,o.remoteSearch=i.search?!0:!1,a.itemName=i.taName,a.taLabel=i.taLabel,n.on("click",function(e){e.stopPropagation()}),s.bind("click",function(){console.log("clicked"),c&&c.closeOthers(a),a.$apply(function(){o.showTooltip()})}),t.click(function(){a.$apply(function(){a.hide=!0})}),s.bind("focus",function(){a.$apply(function(){a.focused=!0})}),s.bind("blur",function(){a.$apply(function(){a.focused=!1})}),r.bind("mouseover",function(){a.$apply(function(){a.mousedOver=!0})}),r.bind("mouseleave",function(){a.$apply(function(){a.mousedOver=!1})}),s.bind("keyup",function(e){13===e.keyCode&&a.$apply(function(){o.selectActive()}),27===e.keyCode&&a.$apply(function(){})}),s.bind("keydown",function(e){(13===e.keyCode||27===e.keyCode)&&e.preventDefault(),40===e.keyCode&&(e.preventDefault(),a.$apply(function(){o.activateNextItem()}),a.hide=!1),8!==e.keyCode||a.term||(e.preventDefault(),a.$apply(function(){o.removeSelectedItem()})),38===e.keyCode&&(e.preventDefault(),a.$apply(function(){o.activatePreviousItem()}))}),a.$watch("taItems",function(e){e&&0!==e.length&&(e.forEach(function(e){e.taId=e[a.itemName],a.selectedItems.forEach(function(t){e[a.itemName]===t[a.itemName]&&(e.selected=!0)})}),a.defaultFlag=!1,o.activate(e.length?e[0]:null))},!0),a.$watch("focused",function(t){t&&e(function(){s.focus()},0,!1)}),a.$watch("isVisible()",function(e){if(e){var t=s.position(),a=s[0].offsetHeight;r.css({width:u,top:t.top+a,left:t.left,position:"absolute",display:"block","z-index":"10","background-color":"white"})}else r.css("display","none")})}}}),angular.module("angular-multi-select").directive("taDropDownItem",function(){return{replace:!0,require:"^taDropDown",transclude:!0,templateUrl:"partials/directive/typeahead/template/taDropDownItem",link:function(e,t,a,n){var i=e.$eval(a.item);e.$on("$destroy",function(){}),t.bind("click",function(){e.$apply(function(){n.select(i)})})}}}),angular.module("angular-multi-select").run(["$templateCache",function(e){e.put("taDropDown.html",'<div class="multi-box"><div class="multi-box-header"><label class="control-label">{{taLabel}}:</label></div><div class="multi-box-detail"><span data-ng-bind="multiSelectItems"></span></div><div class="multi-box-icon"><i class="fa fa-sort-desc"></i></div></div><div data-ng-hide="show" class="shadow-div"><div class="form-group has-feedback"><input type="text" placeholder="search" data-ng-model="term" data-ng-change="query()" class="form-control"/><span data-ng-show="term === \'\'||!term" class="glyphicon glyphicon-search form-control-feedback"></span><span data-ng-show="term &amp;&amp; term !== \'\'" data-ng-click="cancelSearch()" class="glyphicon glyphicon-remove-circle search-box-icon"></span></div><ul class="list-unstyled"><li data-ng-show="selectedItems &amp;&amp; selectedItems.length &gt; 0" class="ta-list-header">Selected Items:</li><ta-drop-down-item item="t" data-ng-repeat="t in selectedItems"><span data-ng-bind="t[itemName]"></span><i class="pull-right fa fa-2x fa-check create-color"></i></ta-drop-down-item><li data-ng-show="defaultFlag" class="ta-list-header">Suggested List:</li><ta-drop-down-item item="i" data-ng-repeat="i in taDefaultItems" data-ng-show="defaultFlag"><span data-ng-bind="i[itemName]"></span></ta-drop-down-item><li data-ng-hide="defaultFlag" class="ta-list-header">Search Results: {{taItems.length}}</li><ta-drop-down-item item="i" data-ng-repeat="i in taItems" data-ng-hide="defaultFlag"><span data-ng-bind="i[itemName]"></span><i data-ng-show="i.selected" class="pull-right fa fa-2x fa-check create-color"></i></ta-drop-down-item></ul></div>'),e.put("taDropDownItem.html",'<!--Created by mayur_2 on 3/22/2016.\n--><li ng-transclude="ng-transclude" class="ta-list-item"></li>')}])}();